const tableStickyObj={},__STICKY_TABLE={doFix(e,t,i){var{uid:l,domType:s,isExist:a}=i;const d=tableStickyObj[l];i=d[s],l=tableStickyObj[l].headerRect;a||(e.style.position="fixed",e.style.zIndex="2001",e.style.top=t+"px"),d.tableWrapDom.style.marginTop=l.height+"px","fixed"===s?e.style.left=i.left+"px":"fixedRight"===s&&(e.style.left=i.left+1+"px")},removeFix(e,t){var{uid:i,domType:t}=t;const l=tableStickyObj[i],s=l[t];e.style.position="static",e.style.top="0",e.style.zIndex="0",l.tableWrapDom.style.marginTop="0","fixed"!==t&&"fixedRight"!==t||(s.dom.style.top="0")},addClass(e,t,i){t=t||0;var l=e.classList.contains("fixed");i.isExist=!!l,l||e.classList.add("fixed"),this.doFix(e,t,i)},removeClass(e,t){e.classList.contains("fixed")&&(e.classList.remove("fixed"),this.removeFix(e,t))},getPosY(e,t){let i=0;var l=e.offsetParent;return null!=l&&"."+e.id!==t&&(i=e.offsetTop,i+=this.getPosY(l,t)),i},getPosX(e){var t=e.offsetLeft;return null!=e.offsetParent&&(t+=this.getPosX(e.offsetParent)),t},fixHead(e,t,i,l){this.fixHead1(this,{scrollDom:e,el:t,uid:i,binding:l})},fixHead1:sticky_throttle((e,{scrollDom:t,el:i,uid:l,binding:s})=>{var a=s.value.top||0,d=i.querySelector(".el-table__header-wrapper"),o=tableStickyObj[l].headerRect.top,n=t.scrollTop,s=tableStickyObj[l].fixed.headerDom,i=tableStickyObj[l].fixedRight.headerDom;o<=n?(t=a+t.getBoundingClientRect().top,e.addClass(d,t,{domType:"mainBody",uid:l}),s&&e.addClass(s,t,{domType:"fixed",uid:l}),i&&e.addClass(i,t,{domType:"fixedRight",uid:l})):(e.removeClass(d,{domType:"mainBody",uid:l}),s&&e.removeClass(s,{domType:"fixed",uid:l}),i&&e.removeClass(i,{domType:"fixedRight",uid:l}))},100,{eventType:"fixHead111"}),setHeadWidth(e){this.setHeadWidth1(this,e)},setHeadWidth1:sticky_debounce((e,t)=>{const{el:i,uid:l,binding:s,eventType:a}=t;var d=tableStickyObj[l]["scrollDom"];const o=i.querySelector(".el-table__header-wrapper");var n=o.getBoundingClientRect().height,r=e.getPosY(o,s.value.parent)-125,t=e.getPosY(d);tableStickyObj[l].headerRect.top=r+n-t/3,tableStickyObj[l].headerRect.height=n,e.initFixedWrap({el:i,uid:l,eventType:a,key:"fixed",className:"el-table__fixed",className1:"el-table__fixed-header-wrapper"}),e.initFixedWrap({el:i,uid:l,eventType:a,key:"fixedRight",className:"el-table__fixed-right",className1:"el-table__fixed-header-wrapper"});var n=i.getElementsByClassName("el-table__body-wrapper")[0],c=getComputedStyle(n).width;const y=i.getElementsByClassName("el-table__header-wrapper");for(let e=0;e<y.length;e++)y[e].style.width=c;e.fixHead(d,i,l,s)}),initFixedWrap(e){const{key:t,el:i,eventType:l,className:s,className1:a,uid:d}=e;if("resize"===l||!tableStickyObj[d][t].dom){var o=i.getElementsByClassName(s);if(o.length){const r=o[0];var n=r.getElementsByClassName(a),e=getComputedStyle(r).width;if(tableStickyObj[d][t].dom=r,n.length){o=this.getPosX(r);const c=n[0];c.style.width=e,tableStickyObj[d][t].left=o,"fixedRight"===t&&(c.classList.add("scroll-bar-h0"),c.style.overflow="auto",c.scrollLeft=c.scrollWidth),c.style.overflow="hidden",tableStickyObj[d][t].headerDom=c}}}},watched({el:t,binding:i,vnode:l,uid:s}){l.context.$watch("isNavFold",e=>{l.context.$nextTick(()=>{setTimeout(()=>{this.setHeadWidth({el:t,uid:s,binding:i,eventType:"resize"})},200)})})}};function sticky_throttle(e,t=300){let i=!0;return function(){i&&(i=!1,setTimeout(()=>{e.apply(this,arguments),i=!0},t))}}function sticky_debounce(i,e,t){const l=e||200;return function(){const e=this,t=arguments;i.timer&&(clearTimeout(i.timer),i.timer=null),i.timer=setTimeout(function(){i.timer=null,i.apply(e,t)},l)}}export default{name:"sticky",inserted(t,i,e){const l=e.componentInstance._uid,s=document.querySelector(i.value.parent)||document.body;tableStickyObj[l]||(tableStickyObj[l]={uid:l,fixFunObj:{},setWidthFunObj:{},autoMoveFunObj:{},scrollDomRect:{},headerRect:{top:0,left:0},fixed:{},fixedRight:{},tableWrapDom:t.getElementsByClassName("el-table__body-wrapper")[0],scrollDom:s}),__STICKY_TABLE.watched({el:t,binding:i,vnode:e,uid:l}),window.addEventListener("resize",tableStickyObj[l].setWidthFunObj=()=>{__STICKY_TABLE.setHeadWidth({el:t,uid:l,binding:i,eventType:"resize"})}),s.addEventListener("scroll",tableStickyObj[l].fixFunObj=e=>{__STICKY_TABLE.fixHead(s,t,l,i)})},componentUpdated(e,t,i){i=i.componentInstance._uid;__STICKY_TABLE.setHeadWidth({el:e,uid:i,binding:t,eventType:"componentUpdated"})},unbind(e,t,i){i=i.componentInstance._uid;window.removeEventListener("resize",tableStickyObj[i].setWidthFunObj);const l=document.querySelector(t.value.parent)||document;l.removeEventListener("scroll",tableStickyObj[i].fixFunObj),t.value.parent&&document.removeEventListener("scroll",tableStickyObj[i].autoMoveFunObj)}};